import os
import pandas as pd 
import datasets

class KSUCCA(datasets.GeneratorBasedBuilder):
	def _info(self):
		return datasets.DatasetInfo(features=datasets.Features({'Text':datasets.Value('string')}))
	def _split_generators(self, dl_manager):
		url = ['https://sourceforge.net/projects/ksucca-corpus/files/KSUCCA%20Files/Corpus.zip']
		downloaded_files = dl_manager.download_and_extract(url)
		return [datasets.SplitGenerator(name=datasets.Split.TRAIN, gen_kwargs={'filepaths': [os.path.join(downloaded_files[0],f) for f in ['Corpus/Corpus/B/B/bb3.txt', 'Corpus/Corpus/B/B/bb1.txt', 'Corpus/Corpus/B/B/bb4.txt', 'Corpus/Corpus/B/B/bb2.txt', 'Corpus/Corpus/B/B/bb6.txt', 'Corpus/Corpus/B/B/bb5.txt', 'Corpus/Corpus/B/D/bd4.txt', 'Corpus/Corpus/B/D/bd7.txt', 'Corpus/Corpus/B/D/bd5.txt', 'Corpus/Corpus/B/D/bd1.txt', 'Corpus/Corpus/B/D/bd2.txt', 'Corpus/Corpus/B/D/bd6.txt', 'Corpus/Corpus/B/D/bd3.txt', 'Corpus/Corpus/B/A/ba3.txt', 'Corpus/Corpus/B/A/ba14.txt', 'Corpus/Corpus/B/A/ba5.txt', 'Corpus/Corpus/B/A/ba12.txt', 'Corpus/Corpus/B/A/ba1.txt', 'Corpus/Corpus/B/A/ba2.txt', 'Corpus/Corpus/B/A/ba9.txt', 'Corpus/Corpus/B/A/ba15.txt', 'Corpus/Corpus/B/A/ba11.txt', 'Corpus/Corpus/B/A/ba6.txt', 'Corpus/Corpus/B/A/ba8.txt', 'Corpus/Corpus/B/A/ba4.txt', 'Corpus/Corpus/B/A/ba7.txt', 'Corpus/Corpus/B/A/ba10.txt', 'Corpus/Corpus/B/A/ba13.txt', 'Corpus/Corpus/B/A/ba16.txt', 'Corpus/Corpus/B/C/bc11.txt', 'Corpus/Corpus/B/C/bc4.txt', 'Corpus/Corpus/B/C/bc22.txt', 'Corpus/Corpus/B/C/bc10.txt', 'Corpus/Corpus/B/C/bc25.txt', 'Corpus/Corpus/B/C/bc5.txt', 'Corpus/Corpus/B/C/bc24.txt', 'Corpus/Corpus/B/C/bc12.txt', 'Corpus/Corpus/B/C/bc14.txt', 'Corpus/Corpus/B/C/bc2.txt', 'Corpus/Corpus/B/C/bc7.txt', 'Corpus/Corpus/B/C/bc21.txt', 'Corpus/Corpus/B/C/bc3.txt', 'Corpus/Corpus/B/C/bc16.txt', 'Corpus/Corpus/B/C/bc20.txt', 'Corpus/Corpus/B/C/bc19.txt', 'Corpus/Corpus/B/C/bc23.txt', 'Corpus/Corpus/B/C/bc26.txt', 'Corpus/Corpus/B/C/bc17.txt', 'Corpus/Corpus/B/C/bc9.txt', 'Corpus/Corpus/B/C/bc27.txt', 'Corpus/Corpus/B/C/bc6.txt', 'Corpus/Corpus/B/C/bc18.txt', 'Corpus/Corpus/B/C/bc1.txt', 'Corpus/Corpus/B/C/bc8.txt', 'Corpus/Corpus/B/C/bc15.txt', 'Corpus/Corpus/B/C/bc13.txt', 'Corpus/Corpus/D/G/dg1.txt', 'Corpus/Corpus/D/B/db7.txt', 'Corpus/Corpus/D/B/db13.txt', 'Corpus/Corpus/D/B/db1.txt', 'Corpus/Corpus/D/B/db10.txt', 'Corpus/Corpus/D/B/db6.txt', 'Corpus/Corpus/D/B/db11.txt', 'Corpus/Corpus/D/B/db3.txt', 'Corpus/Corpus/D/B/db2.txt', 'Corpus/Corpus/D/B/db4.txt', 'Corpus/Corpus/D/B/db12.txt', 'Corpus/Corpus/D/B/db8.txt', 'Corpus/Corpus/D/B/db9.txt', 'Corpus/Corpus/D/B/db14.txt', 'Corpus/Corpus/D/B/db5.txt', 'Corpus/Corpus/D/D/dd1.txt', 'Corpus/Corpus/D/A/da6.txt', 'Corpus/Corpus/D/A/da17.txt', 'Corpus/Corpus/D/A/da14.txt', 'Corpus/Corpus/D/A/da19.txt', 'Corpus/Corpus/D/A/da10.txt', 'Corpus/Corpus/D/A/da5.txt', 'Corpus/Corpus/D/A/da7.txt', 'Corpus/Corpus/D/A/da9.txt', 'Corpus/Corpus/D/A/da18.txt', 'Corpus/Corpus/D/A/da1.txt', 'Corpus/Corpus/D/A/da16.txt', 'Corpus/Corpus/D/A/da8.txt', 'Corpus/Corpus/D/A/da15.txt', 'Corpus/Corpus/D/A/da12.txt', 'Corpus/Corpus/D/A/da2.txt', 'Corpus/Corpus/D/A/da3.txt', 'Corpus/Corpus/D/A/da11.txt', 'Corpus/Corpus/D/A/da4.txt', 'Corpus/Corpus/D/A/da13.txt', 'Corpus/Corpus/D/C/dc2.txt', 'Corpus/Corpus/D/C/dc1.txt', 'Corpus/Corpus/D/C/dc3.txt', 'Corpus/Corpus/D/F/df1.txt', 'Corpus/Corpus/D/E/de2.txt', 'Corpus/Corpus/D/E/de1.txt', 'Corpus/Corpus/D/H/dh1.txt', 'Corpus/Corpus/A/G/ag4.txt', 'Corpus/Corpus/A/G/ag7.txt', 'Corpus/Corpus/A/G/ag20.txt', 'Corpus/Corpus/A/G/ag2.txt', 'Corpus/Corpus/A/G/ag21.txt', 'Corpus/Corpus/A/G/ag9.txt', 'Corpus/Corpus/A/G/ag24.txt', 'Corpus/Corpus/A/G/ag15.txt', 'Corpus/Corpus/A/G/ag5.txt', 'Corpus/Corpus/A/G/ag26.txt', 'Corpus/Corpus/A/G/ag1.txt', 'Corpus/Corpus/A/G/ag19.txt', 'Corpus/Corpus/A/G/ag6.txt', 'Corpus/Corpus/A/G/ag17.txt', 'Corpus/Corpus/A/G/ag10.txt', 'Corpus/Corpus/A/G/ag23.txt', 'Corpus/Corpus/A/G/ag12.txt', 'Corpus/Corpus/A/G/ag13.txt', 'Corpus/Corpus/A/G/ag14.txt', 'Corpus/Corpus/A/G/ag11.txt', 'Corpus/Corpus/A/G/ag25.txt', 'Corpus/Corpus/A/G/ag22.txt', 'Corpus/Corpus/A/G/ag3.txt', 'Corpus/Corpus/A/G/ag16.txt', 'Corpus/Corpus/A/G/ag18.txt', 'Corpus/Corpus/A/G/ag8.txt', 'Corpus/Corpus/A/B/ab37.txt', 'Corpus/Corpus/A/B/ab13.txt', 'Corpus/Corpus/A/B/ab28.txt', 'Corpus/Corpus/A/B/ab17.txt', 'Corpus/Corpus/A/B/ab7.txt', 'Corpus/Corpus/A/B/ab6.txt', 'Corpus/Corpus/A/B/ab42.txt', 'Corpus/Corpus/A/B/ab39.txt', 'Corpus/Corpus/A/B/ab3.txt', 'Corpus/Corpus/A/B/ab41.txt', 'Corpus/Corpus/A/B/ab24.txt', 'Corpus/Corpus/A/B/ab4.txt', 'Corpus/Corpus/A/B/ab22.txt', 'Corpus/Corpus/A/B/ab5.txt', 'Corpus/Corpus/A/B/ab21.txt', 'Corpus/Corpus/A/B/ab14.txt', 'Corpus/Corpus/A/B/ab16.txt', 'Corpus/Corpus/A/B/ab27.txt', 'Corpus/Corpus/A/B/ab33.txt', 'Corpus/Corpus/A/B/ab1.txt', 'Corpus/Corpus/A/B/ab10.txt', 'Corpus/Corpus/A/B/ab18.txt', 'Corpus/Corpus/A/B/ab2.txt', 'Corpus/Corpus/A/B/ab26.txt', 'Corpus/Corpus/A/B/ab15.txt', 'Corpus/Corpus/A/B/ab11.txt', 'Corpus/Corpus/A/B/ab43.txt', 'Corpus/Corpus/A/B/ab25.txt', 'Corpus/Corpus/A/B/ab38.txt', 'Corpus/Corpus/A/B/ab23.txt', 'Corpus/Corpus/A/B/ab20.txt', 'Corpus/Corpus/A/B/ab40.txt', 'Corpus/Corpus/A/B/ab32.txt', 'Corpus/Corpus/A/B/ab44.txt', 'Corpus/Corpus/A/B/ab9.txt', 'Corpus/Corpus/A/B/ab8.txt', 'Corpus/Corpus/A/B/ab12.txt', 'Corpus/Corpus/A/B/ab36.txt', 'Corpus/Corpus/A/B/ab19.txt', 'Corpus/Corpus/A/B/ab30.txt', 'Corpus/Corpus/A/B/ab31.txt', 'Corpus/Corpus/A/B/ab29.txt', 'Corpus/Corpus/A/B/ab34.txt', 'Corpus/Corpus/A/B/ab35.txt', 'Corpus/Corpus/A/D/ad4.txt', 'Corpus/Corpus/A/D/ad27.txt', 'Corpus/Corpus/A/D/ad20.txt', 'Corpus/Corpus/A/D/ad28.txt', 'Corpus/Corpus/A/D/ad17.txt', 'Corpus/Corpus/A/D/ad12.txt', 'Corpus/Corpus/A/D/ad5.txt', 'Corpus/Corpus/A/D/ad13.txt', 'Corpus/Corpus/A/D/ad8.txt', 'Corpus/Corpus/A/D/ad21.txt', 'Corpus/Corpus/A/D/ad10.txt', 'Corpus/Corpus/A/D/ad15.txt', 'Corpus/Corpus/A/D/ad14.txt', 'Corpus/Corpus/A/D/ad11.txt', 'Corpus/Corpus/A/D/ad18.txt', 'Corpus/Corpus/A/D/ad1.txt', 'Corpus/Corpus/A/D/ad25.txt', 'Corpus/Corpus/A/D/ad24.txt', 'Corpus/Corpus/A/D/ad3.txt', 'Corpus/Corpus/A/D/ad9.txt', 'Corpus/Corpus/A/D/ad19.txt', 'Corpus/Corpus/A/D/ad7.txt', 'Corpus/Corpus/A/D/ad6.txt', 'Corpus/Corpus/A/D/ad26.txt', 'Corpus/Corpus/A/D/ad2.txt', 'Corpus/Corpus/A/D/ad29.txt', 'Corpus/Corpus/A/D/ad23.txt', 'Corpus/Corpus/A/D/ad22.txt', 'Corpus/Corpus/A/D/ad16.txt', 'Corpus/Corpus/A/A/aa1.txt', 'Corpus/Corpus/A/C/ac13.txt', 'Corpus/Corpus/A/C/ac5.txt', 'Corpus/Corpus/A/C/ac6.txt', 'Corpus/Corpus/A/C/ac9.txt', 'Corpus/Corpus/A/C/ac11.txt', 'Corpus/Corpus/A/C/ac3.txt', 'Corpus/Corpus/A/C/ac4.txt', 'Corpus/Corpus/A/C/ac10.txt', 'Corpus/Corpus/A/C/ac7.txt', 'Corpus/Corpus/A/C/ac2.txt', 'Corpus/Corpus/A/C/ac8.txt', 'Corpus/Corpus/A/C/ac12.txt', 'Corpus/Corpus/A/C/ac1.txt', 'Corpus/Corpus/A/F/af21.txt', 'Corpus/Corpus/A/F/af14.txt', 'Corpus/Corpus/A/F/af7.txt', 'Corpus/Corpus/A/F/af19.txt', 'Corpus/Corpus/A/F/af4.txt', 'Corpus/Corpus/A/F/af12.txt', 'Corpus/Corpus/A/F/af15.txt', 'Corpus/Corpus/A/F/af16.txt', 'Corpus/Corpus/A/F/af3.txt', 'Corpus/Corpus/A/F/af23.txt', 'Corpus/Corpus/A/F/af9.txt', 'Corpus/Corpus/A/F/af18.txt', 'Corpus/Corpus/A/F/af5.txt', 'Corpus/Corpus/A/F/af8.txt', 'Corpus/Corpus/A/F/af11.txt', 'Corpus/Corpus/A/F/af20.txt', 'Corpus/Corpus/A/F/af1.txt', 'Corpus/Corpus/A/F/af10.txt', 'Corpus/Corpus/A/F/af13.txt', 'Corpus/Corpus/A/F/af17.txt', 'Corpus/Corpus/A/F/af2.txt', 'Corpus/Corpus/A/F/af22.txt', 'Corpus/Corpus/A/F/af6.txt', 'Corpus/Corpus/A/E/ae8.txt', 'Corpus/Corpus/A/E/ae5.txt', 'Corpus/Corpus/A/E/ae4.txt', 'Corpus/Corpus/A/E/ae7.txt', 'Corpus/Corpus/A/E/ae1.txt', 'Corpus/Corpus/A/E/ae10.txt', 'Corpus/Corpus/A/E/ae3.txt', 'Corpus/Corpus/A/E/ae6.txt', 'Corpus/Corpus/A/E/ae9.txt', 'Corpus/Corpus/A/E/ae2.txt', 'Corpus/Corpus/A/H/ah2.txt', 'Corpus/Corpus/A/H/ah3.txt', 'Corpus/Corpus/A/H/ah1.txt', 'Corpus/Corpus/A/H/ah4.txt', 'Corpus/Corpus/C/B/cb2.txt', 'Corpus/Corpus/C/B/cb1.txt', 'Corpus/Corpus/C/A/ca28.txt', 'Corpus/Corpus/C/A/ca12.txt', 'Corpus/Corpus/C/A/ca33.txt', 'Corpus/Corpus/C/A/ca27.txt', 'Corpus/Corpus/C/A/ca35.txt', 'Corpus/Corpus/C/A/ca16.txt', 'Corpus/Corpus/C/A/ca23.txt', 'Corpus/Corpus/C/A/ca4.txt', 'Corpus/Corpus/C/A/ca19.txt', 'Corpus/Corpus/C/A/ca25.txt', 'Corpus/Corpus/C/A/ca39.txt', 'Corpus/Corpus/C/A/ca14.txt', 'Corpus/Corpus/C/A/ca26.txt', 'Corpus/Corpus/C/A/ca32.txt', 'Corpus/Corpus/C/A/ca29.txt', 'Corpus/Corpus/C/A/ca5.txt', 'Corpus/Corpus/C/A/ca34.txt', 'Corpus/Corpus/C/A/ca7.txt', 'Corpus/Corpus/C/A/ca40.txt', 'Corpus/Corpus/C/A/ca15.txt', 'Corpus/Corpus/C/A/ca22.txt', 'Corpus/Corpus/C/A/ca10.txt', 'Corpus/Corpus/C/A/ca18.txt', 'Corpus/Corpus/C/A/ca8.txt', 'Corpus/Corpus/C/A/ca24.txt', 'Corpus/Corpus/C/A/ca21.txt', 'Corpus/Corpus/C/A/ca20.txt', 'Corpus/Corpus/C/A/ca42.txt', 'Corpus/Corpus/C/A/ca17.txt', 'Corpus/Corpus/C/A/ca1.txt', 'Corpus/Corpus/C/A/ca30.txt', 'Corpus/Corpus/C/A/ca36.txt', 'Corpus/Corpus/C/A/ca31.txt', 'Corpus/Corpus/C/A/ca11.txt', 'Corpus/Corpus/C/A/ca41.txt', 'Corpus/Corpus/C/A/ca13.txt', 'Corpus/Corpus/C/A/ca38.txt', 'Corpus/Corpus/C/A/ca9.txt', 'Corpus/Corpus/C/A/ca6.txt', 'Corpus/Corpus/C/A/ca2.txt', 'Corpus/Corpus/C/A/ca3.txt', 'Corpus/Corpus/C/A/ca37.txt', 'Corpus/Corpus/C/C/cc57.txt', 'Corpus/Corpus/C/C/cc33.txt', 'Corpus/Corpus/C/C/cc12.txt', 'Corpus/Corpus/C/C/cc42.txt', 'Corpus/Corpus/C/C/cc2.txt', 'Corpus/Corpus/C/C/cc13.txt', 'Corpus/Corpus/C/C/cc54.txt', 'Corpus/Corpus/C/C/cc44.txt', 'Corpus/Corpus/C/C/cc47.txt', 'Corpus/Corpus/C/C/cc28.txt', 'Corpus/Corpus/C/C/cc56.txt', 'Corpus/Corpus/C/C/cc46.txt', 'Corpus/Corpus/C/C/cc19.txt', 'Corpus/Corpus/C/C/cc16.txt', 'Corpus/Corpus/C/C/cc7.txt', 'Corpus/Corpus/C/C/cc29.txt', 'Corpus/Corpus/C/C/cc45.txt', 'Corpus/Corpus/C/C/cc10.txt', 'Corpus/Corpus/C/C/cc17.txt', 'Corpus/Corpus/C/C/cc31.txt', 'Corpus/Corpus/C/C/cc52.txt', 'Corpus/Corpus/C/C/cc55.txt', 'Corpus/Corpus/C/C/cc59.txt', 'Corpus/Corpus/C/C/cc24.txt', 'Corpus/Corpus/C/C/cc53.txt', 'Corpus/Corpus/C/C/cc9.txt', 'Corpus/Corpus/C/C/cc3.txt', 'Corpus/Corpus/C/C/cc36.txt', 'Corpus/Corpus/C/C/cc30.txt', 'Corpus/Corpus/C/C/cc39.txt', 'Corpus/Corpus/C/C/cc5.txt', 'Corpus/Corpus/C/C/cc1.txt', 'Corpus/Corpus/C/C/cc26.txt', 'Corpus/Corpus/C/C/cc22.txt', 'Corpus/Corpus/C/C/cc43.txt', 'Corpus/Corpus/C/C/cc11.txt', 'Corpus/Corpus/C/C/cc27.txt', 'Corpus/Corpus/C/C/cc23.txt', 'Corpus/Corpus/C/C/cc6.txt', 'Corpus/Corpus/C/C/cc50.txt', 'Corpus/Corpus/C/C/cc20.txt', 'Corpus/Corpus/C/C/cc58.txt', 'Corpus/Corpus/C/C/cc4.txt', 'Corpus/Corpus/C/C/cc38.txt', 'Corpus/Corpus/C/C/cc41.txt', 'Corpus/Corpus/C/C/cc34.txt', 'Corpus/Corpus/C/C/cc37.txt', 'Corpus/Corpus/C/C/cc49.txt', 'Corpus/Corpus/C/C/cc14.txt', 'Corpus/Corpus/C/C/cc32.txt', 'Corpus/Corpus/C/C/cc51.txt', 'Corpus/Corpus/C/C/cc21.txt', 'Corpus/Corpus/C/C/cc15.txt', 'Corpus/Corpus/C/C/cc18.txt', 'Corpus/Corpus/C/C/cc35.txt', 'Corpus/Corpus/C/C/cc60.txt', 'Corpus/Corpus/C/C/cc40.txt', 'Corpus/Corpus/C/C/cc8.txt', 'Corpus/Corpus/C/C/cc25.txt', 'Corpus/Corpus/C/C/cc48.txt', 'Corpus/Corpus/F/B/fb11.txt', 'Corpus/Corpus/F/B/fb16.txt', 'Corpus/Corpus/F/B/fb17.txt', 'Corpus/Corpus/F/B/fb8.txt', 'Corpus/Corpus/F/B/fb1.txt', 'Corpus/Corpus/F/B/fb14.txt', 'Corpus/Corpus/F/B/fb4.txt', 'Corpus/Corpus/F/B/fb6.txt', 'Corpus/Corpus/F/B/fb13.txt', 'Corpus/Corpus/F/B/fb10.txt', 'Corpus/Corpus/F/B/fb9.txt', 'Corpus/Corpus/F/B/fb7.txt', 'Corpus/Corpus/F/B/fb15.txt', 'Corpus/Corpus/F/B/fb5.txt', 'Corpus/Corpus/F/B/fb12.txt', 'Corpus/Corpus/F/B/fb2.txt', 'Corpus/Corpus/F/B/fb3.txt', 'Corpus/Corpus/F/B/fb18.txt', 'Corpus/Corpus/F/A/fa2.txt', 'Corpus/Corpus/F/A/fa6.txt', 'Corpus/Corpus/F/A/fa1.txt', 'Corpus/Corpus/F/A/fa8.txt', 'Corpus/Corpus/F/A/fa7.txt', 'Corpus/Corpus/F/A/fa5.txt', 'Corpus/Corpus/F/A/fa4.txt', 'Corpus/Corpus/F/A/fa3.txt', 'Corpus/Corpus/E/B/eb8.txt', 'Corpus/Corpus/E/B/eb4.txt', 'Corpus/Corpus/E/B/eb3.txt', 'Corpus/Corpus/E/B/eb5.txt', 'Corpus/Corpus/E/B/eb9.txt', 'Corpus/Corpus/E/B/eb1.txt', 'Corpus/Corpus/E/B/eb6.txt', 'Corpus/Corpus/E/B/eb2.txt', 'Corpus/Corpus/E/B/eb7.txt', 'Corpus/Corpus/E/A/ea11.txt', 'Corpus/Corpus/E/A/ea10.txt', 'Corpus/Corpus/E/A/ea12.txt', 'Corpus/Corpus/E/A/ea23.txt', 'Corpus/Corpus/E/A/ea4.txt', 'Corpus/Corpus/E/A/ea1.txt', 'Corpus/Corpus/E/A/ea21.txt', 'Corpus/Corpus/E/A/ea2.txt', 'Corpus/Corpus/E/A/ea8.txt', 'Corpus/Corpus/E/A/ea15.txt', 'Corpus/Corpus/E/A/ea20.txt', 'Corpus/Corpus/E/A/ea5.txt', 'Corpus/Corpus/E/A/ea13.txt', 'Corpus/Corpus/E/A/ea16.txt', 'Corpus/Corpus/E/A/ea22.txt', 'Corpus/Corpus/E/A/ea14.txt', 'Corpus/Corpus/E/A/ea3.txt', 'Corpus/Corpus/E/A/ea6.txt', 'Corpus/Corpus/E/A/ea9.txt', 'Corpus/Corpus/E/A/ea17.txt', 'Corpus/Corpus/E/A/ea7.txt', 'Corpus/Corpus/E/A/ea19.txt', 'Corpus/Corpus/E/A/ea18.txt']]})]

	def read_txt(self, filepath):
		lines = open(filepath, 'r').read().splitlines()
		return pd.DataFrame(lines)
	def _generate_examples(self, filepaths):
		_id = 0
		labels = None
		for i,filepath in enumerate(filepaths):
			df = self.read_txt(filepath)
			df.columns = ['Text']
			for _, record in df.iterrows():
				yield str(_id), {'Text':record['Text']}
				_id += 1 

